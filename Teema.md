MapView 仕様書（展示会版）
1. 基本情報
バージョン：v0.1（作成日：2025/08/09）


作成者：おぼろげ


対象イベント：生成AIなんでも展示会 2025/09/06


目的：AIキャラが暮らす世界を遠景から鑑賞できるMapViewを制作する


MVP定義：
3Dで表現
AIキャラ同士が会話をする
自動で動く

2. コンセプト
来場者に与える印象：「本当にAIが暮らしているように感じる」


演出の主軸：全景の賑わい／キャラ間のやりとり／感情表現・個性


テーマ：夏祭り×ネオスフィア



3. スコープ / 非スコープ
スコープ（MVP）
3D夏祭りマップ
3体のAIキャラ
吹き出し会話
３人以上にも対応（途中会話参加もできる）
キャラの動きについて
ポイントを設置し、乱数で選択させルートを決定する
AIキャラ同士が近づいたら引き合って話す
話し始めたら止まる
6ターン終わったら会話を終了し、離れてそれぞれのルートに戻る
会話の内容(感情表現・個性など)
AITuberのモデルを基本に
基本的な応答
直近の会話のみ記憶
キャラによって個性は変える
なちなにさんのキャラ案を使用してプロンプトを作成
カメラについて
見下ろし型（斜め）
クリックしたらズーム
（後々調整）
非スコープ（今回やらないこと）
会話の内容
複雑な感情などの構造化はいらない→プロンプトで処理
カメラ
追従まで入らない



4. キャラ挙動仕様
個性差分：歩く速度0.8〜1.2倍


行動ループ：ポイント巡回→会話開始→止まる→会話終了→移動（ループ間隔：20〜40秒）


モーション：歩きモーション・話している最中に身振り手振り



5. 会話・感情表現仕様
方法：吹き出し


トリガー条件：お互いの距離が近づいた時（半径を設定）



6. 会話仕様
文体：短文・口語的（1行15〜40文字）


生成方式：LLMのAPI（モデルはGPT-5 mini or Chat）


文脈演出：「昨日」「明日」など日常の継続感を出す。夏祭りに関することを話す。近くの屋台の話をする。



8. カメラ・視点仕様
見下ろし型
クリックでズーム（追従なし）

9. 時間・環境演出
時間帯変化：夕景→夜（5分サイクル）
音響：BGMのみ



10. 技術仕様
構成


表示：Unity 2022（URP）/ WebGL


サーバ：Python 3.11 + Flask（REST）/ Flask‑SocketIO（通知）


実行/配信


ローカルPC単体運用（LAN公開なし）


Flaskで Build/WebGL を静的配信


データ


agents.json（個性・ルート・口調）事前ロード


session_state.json（F1リセット対象）


API（最小）


GET /healthz


GET /config/agents


POST /dialog/turn（1ターン生成：LLM or テンプレ）


WebSocket（最小）


サーバ → クライアント：state/turn（テキスト/感情）


クライアント → サーバ：client/proximity（近接通知）


オフライン対応


.env: ONLINE=false でテンプレ応答に自動切替（屋台/天気/日付の簡易話題）


パフォーマンス目安


1080p 60fps（下限45fps）


同時会話セッション上限：6


起動手順（最小）


python app.py


Unity WebGLを全画面表示


依存


Flask, Flask-SocketIO, gevent, python-dotenv, orjson


フォルダ例

 bash
CopyEdit
/server
  app.py
  data/agents.json
  data/session_state.json
  .env
/unity/Build/WebGL  # Flaskで配信



11. 展示運用仕様
起動手順：PC電源ON→Unityエディター起動→ビューを大きく表示


監視方法：異常時は再起動


リセット方法：F1キーで即リロード



12. アセット一覧
3Dモデル：屋台×8、キャラモデル×3


テクスチャ：地面、夜空、夕空


サウンド：BGMのみ


ライセンス：商用利用可／再配布不可（制作者明記）



13. スケジュール
α版（2025/08/13 水）
3D夏祭りマップの仮配置（屋台・地面・背景モデル読み込み）


AIキャラ3体の基本モデル読み込み＆位置固定で表示確認


カメラの見下ろし型視点を実装（ズーム機能は未実装可）


吹き出し表示の枠組み（ダミーテキストでOK）


β版（2025/08/20 水）
キャラ巡回ルートのポイント配置と乱数選択移動の実装


キャラ間距離による会話トリガー処理（接近→会話開始→離脱）


会話時の停止＆モーション切替（歩き⇔話す）


吹き出しにLLMの短文会話を反映（プロンプトの仮組み）


夕景→夜への時間帯変化（5分サイクル）の基本実装


RC版（2025/08/27 水）
キャラの個性パラメータ反映（速度差0.8〜1.2倍、話し方の違い）


夏祭りテーマに沿った会話プロンプトの調整（「昨日」「明日」等の継続感）


カメラズームの調整（UIでズームレベル確認）


モーション自然化（身振り手振りのタイミング改善）


同時40体表示時のパフォーマンステスト（fps計測）


展示会本番（2025/09/06 土）
安定版ビルド（WebGL or Standalone）


展示会用起動スクリプトとリセットキー確認


全モデル・テクスチャの最終差し替え（商用利用可素材のみ）


当日動作確認マニュアルと再起動手順共有
